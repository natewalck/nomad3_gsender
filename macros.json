[
 {
  "name": "BitSetterToolChange",
  "content": ";Bitsetter measure tool better\n\n; Wait until the planner queue is empty\n%wait\n\n%global.state.SAFE_HEIGHT = -10          ; clear everything height(negative number, distance below Z limit)\n; Set BitSetter probe location\n%global.state.BITSETTER_X_LOCATION = -5  ; machine coordinates\n%global.state.BITSETTER_Y_LOCATION = -3  ; machine coordinates\n%global.state.BITSETTER_Z_LOCATION = -20 ; machine coordinates --> lower this (more negative) to start the probing closer to wasteboard\n\n; Location for tool changes\n%global.state.TOOLCHANGE_X = -125\n\n%global.state.BITSETTER_PROBE_DISTANCE = 100\n%global.state.BITSETTER_PROBE_FEEDRATE = 300 ; mm/min\n\n; Wait until the planner queue is empty\n%wait\n\n; Keep a backup of current work position\n%X0=posx, Y0=posy, Z0=posz\n\n; Save modal state\n%WCS = modal.wcs\n%PLANE = modal.plane\n%UNITS = modal.units\n%DISTANCE = modal.distance\n%FEEDRATE = modal.feedrate\n%SPINDLE = modal.spindle\n%COOLANT = modal.coolant\n\nG21 ; metric\nM5  ; Stop spindle\nG90 ; Absolute positioning\n\n; Get to a safe height and park for tool change\nG53 G0 Z[global.state.SAFE_HEIGHT]\nG53 X[global.state.TOOLCHANGE_X] Y[global.state.BITSETTER_Y_LOCATION]\n\n; Pause for manual tool change & probing\n%wait\nM0 ; Please insert a tool\n\n; Go to BitSetter\nG53 X[global.state.BITSETTER_X_LOCATION] Y[global.state.BITSETTER_Y_LOCATION]\nG53 Z[global.state.BITSETTER_Z_LOCATION]\n\n%probe_start_z = posz\n\nG91 ; Relative positioning\n\nG38.2 z-[global.state.BITSETTER_PROBE_DISTANCE] F[global.state.BITSETTER_PROBE_FEEDRATE]; fast probe (so it doesn't take forever)\nG0 z2\nG38.2 z-5 F40 ; \"dial-it-in\" probes\nG4 P.25\nG38.4 z10 F20\nG4 P.25\nG38.2 z-2 F10\nG4 P.25\nG38.4 z10 F5\nG4 P.25\n\nG90 ; Abosolute positioning\n%wait\n\n; Get the Z position at the end of measuring tool length\n%probe_end_z = posz\n%probe_actual_distance = probe_start_z - probe_end_z\n%is_initial_tool = ! (global.state.PROBE_ACTUAL_DISTANCE > 0)\n\n; Update Z offset for new tool\n; note: do this in individual steps otherwise it sometimes treats some variables as strings (wtf??)\n;     resulting in new_z=-31.0423.3225252\n\n%delta_z = is_initial_tool ? 0 : probe_actual_distance*1.0 - global.state.PROBE_ACTUAL_DISTANCE*1.0\n%new_z = posz*1.0 + delta_z*1.0\n%new_z  =  Math.round(new_z * 1000) / 1000\n(old=[global.state.PROBE_ACTUAL_DISTANCE] new=[probe_actual_distance] new_z=[new_z])\n\nG10 L20 Z[new_z]\n\n%global.state.PROBE_ACTUAL_DISTANCE = probe_actual_distance\n\n%wait\n\nG91 ; Relative positioning\nG0 Z5\nG90 ; Absolute positioning\nG53 Z[global.state.SAFE_HEIGHT] ; Move in machine coordinates to safe height\n%wait\n; Go to work zero at a SAFE_HEIGHT for Z\nG0 X0 Y0\n\n; Restore modal state\n[PLANE] [UNITS] [DISTANCE] [FEEDRATE] [SPINDLE] [COOLANT]"
 },
 {
  "name": "BitZero XYZ",
  "content": ";BitZero V2\n\n;Start with end mill in hole, BELOW Z surface of probe\n\n; Wait until the planner queue is empty\n%wait\n\n; Set user-defined variables\n%Z_PROBE_THICKNESS = 13.02\t;thickness of Z probe plate\n%PROBE_DISTANCE = 20  ;Max distance for a probe motion\n%PROBE_FEEDRATE_A = 150\n%PROBE_FEEDRATE_B = 30\n%PROBE_MAJOR_RETRACT = 3  ;distance of retract before probing opposite side\n%Z_PROBE = 15\t; Lift out of hole and Max Z probe\n%Z_PROBE_KEEPOUT = 15\t;distance (X&Y) from edge of hole for Z probe\n%Z_FINAL = 15\t;final height above probe\n\n\n%UNITS=modal.units\n%DISTANCE=modal.distance\n\n\nG91 ; Relative positioning\nG21 ;Use millimeters\n\n; Probe X\n; Probe toward right side of hole with a maximum probe distance\nG38.2 X[PROBE_DISTANCE] F[PROBE_FEEDRATE_A]\nG0 X-2 ;retract 2mm\nG38.2 X5 F[PROBE_FEEDRATE_B] ;Slow Probe\n%X_RIGHT = posx\nG0 X-[PROBE_MAJOR_RETRACT]\t;retract\n\n; Probe toward Left side of hole with a maximum probe distance\nG38.2 X-[PROBE_DISTANCE] F[PROBE_FEEDRATE_A]\nG0 X2 ;retract 2mm\nG38.2 X-5 F[PROBE_FEEDRATE_B] ;Slow Probe\n%X_LEFT = posx\n%X_CHORD = X_RIGHT - X_LEFT\nG0 X[X_CHORD/2]\n%X_CENTER = posx\t;get X-value of hole center for some reason\n; A dwell time of one second to make sure the planner queue is empty\nG4 P1\nG10L20X0\n\n; Probe Y\n; Probe toward top side of hole with a maximum probe distance\nG38.2 Y[PROBE_DISTANCE] F[PROBE_FEEDRATE_A]\nG0 Y-2 ;retract 2mm\nG38.2 Y5 F[PROBE_FEEDRATE_B] ;Slow Probe\n%Y_TOP = posy\nG0 Y-[PROBE_MAJOR_RETRACT]\t;retract\n; Probe toward bottom side of hole with a maximum probe distance\nG38.2 Y-[PROBE_DISTANCE] F[PROBE_FEEDRATE_A]\nG0 Y2 ;retract 2mm\nG38.2 Y-5 F[PROBE_FEEDRATE_B] ;Slow Probe\n%Y_BTM = posy\n%Y_CHORD = Y_TOP - Y_BTM\n%HOLE_RADIUS = Y_CHORD/2\nG0 Y[HOLE_RADIUS]\n%Y_CENTER = posy\t;get Y-value of hole center for some reason\n; A dwell time of one second to make sure the planner queue is empty\nG4 P1\nG10L20Y0\n\n; Probe Z\nG0 Z15\nG0 X10 Y10\nG38.2 Z-[Z_PROBE] F[PROBE_FEEDRATE_A]\nG0 Z2 ;retract 2mm\nG38.2 Z-15 F[PROBE_FEEDRATE_B] ;Slow Probe\nG10L20Z[Z_PROBE_THICKNESS]\nG0 Z[Z_FINAL+10]\t;raise Z\nG90\t;absolute distance\nG0 X0 Y0\n; A dwell time of one second to make sure the planner queue is empty\nG4 P1\n\n[UNITS] [DISTANCE] ;restore unit and distance modal state\n"
 },
 {
  "name": "BitZero Z Only",
  "content": ";BitZero V2\n\n;Start with end mill in hole, BELOW Z surface of probe\n\n; Wait until the planner queue is empty\n%wait\n\n; Set user-defined variables\n%Z_PROBE_THICKNESS = 13.02\t;thickness of Z probe plate\n%PROBE_DISTANCE = 20  ;Max distance for a probe motion\n%PROBE_FEEDRATE_A = 150\n%PROBE_FEEDRATE_B = 30\n%PROBE_MAJOR_RETRACT = 3  ;distance of retract before probing opposite side\n%Z_PROBE = 15\t; Lift out of hole and Max Z probe\n%Z_FINAL = 15\t; Final height above probe\n\n\n%UNITS=modal.units\n%DISTANCE=modal.distance\n\n\nG91 ; Relative positioning\nG21 ; Use millimeters\n\n; Probe Z\nG38.2 Z-[Z_PROBE] F[PROBE_FEEDRATE_A]\nG0 Z2 ;retract 2mm\nG38.2 Z-15 F[PROBE_FEEDRATE_B] ;Slow Probe\nG10L20Z[Z_PROBE_THICKNESS]\nG0 Z[Z_FINAL+10]\t;raise Z\nG90\t;absolute distance\nG0 X0 Y0\n; A dwell time of one second to make sure the planner queue is empty\nG4 P1\n\n[UNITS] [DISTANCE] ;restore unit and distance modal state"
 },
 {
  "name": "BitZero Modvise Z",
  "content": ";BitZero V2\n\n;Start with end mill in hole, BELOW Z surface of probe\n\n; Wait until the planner queue is empty\n%wait\n\n; Set user-defined variables\n%Z_PROBE_THICKNESS = 13.02\t;thickness of Z probe plate\n%MODVISE_PARALLEL_HEIGHT = 25.4\n%MODVISE_Z_OFFSET = Z_PROBE_THICKNESS - MODVISE_PARALLEL_HEIGHT\n%PROBE_DISTANCE = 20  ;Max distance for a probe motion\n%PROBE_FEEDRATE_A = 150\n%PROBE_FEEDRATE_B = 30\n%PROBE_MAJOR_RETRACT = 3  ;distance of retract before probing opposite side\n%Z_PROBE = 15\t; Lift out of hole and Max Z probe\n%Z_FINAL = 15\t; Final height above probe\n\n\n%UNITS=modal.units\n%DISTANCE=modal.distance\n\n\nG91 ; Relative positioning\nG21 ; Use millimeters\n\n; Probe Z\nG38.2 Z-[Z_PROBE] F[PROBE_FEEDRATE_A]\nG0 Z2 ;retract 2mm\nG38.2 Z-15 F[PROBE_FEEDRATE_B] ;Slow Probe\nG10L20Z[MODVISE_Z_OFFSET]\nG0 Z[Z_FINAL+10]\t;raise Z\nG90\t;absolute distance\nG0 X0 Y0\n; A dwell time of one second to make sure the planner queue is empty\nG4 P1\n\n[UNITS] [DISTANCE] ;restore unit and distance modal state"
 }
]